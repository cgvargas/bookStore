{% load i18n %}

<!-- IMPORTANTE: Nav-sidebar PRIMEIRO, botÃ£o DEPOIS -->
<nav class="module custom-scrollbar" id="nav-sidebar">
  {% if available_apps %}
    <div class="app-modules">
      <!-- ğŸ› ï¸ MÃ“DULO DE DIAGNÃ“STICOS -->
      <div class="app-module" id="app-diagnostics">
        <table>
          <caption>
            <a href="{% url 'admin:diagnostics_dashboard' %}" class="section">ğŸ› ï¸ DiagnÃ³sticos</a>
          </caption>
          <tr class="model-dashboard{% if 'diagnostics/' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="{% url 'admin:diagnostics_dashboard' %}"{% if 'diagnostics/' in request.path and 'diagnostics/performance' not in request.path and 'diagnostics/redis' not in request.path %} aria-current="page"{% endif %}>
                ğŸš€ Dashboard
              </a>
            </th>
          </tr>
          <tr class="model-performance{% if 'diagnostics/performance' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="{% url 'admin:performance_diagnostics' %}"{% if 'diagnostics/performance' in request.path %} aria-current="page"{% endif %}>
                âš¡ Performance
              </a>
            </th>
          </tr>
          <tr class="model-redis{% if 'diagnostics/redis-info' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="{% url 'admin:redis_info' %}"{% if 'diagnostics/redis-info' in request.path %} aria-current="page"{% endif %}>
                ğŸ’¾ Redis Info
              </a>
            </th>
          </tr>
          <tr class="model-cache{% if 'diagnostics/clear-cache' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="{% url 'admin:clear_cache' %}"{% if 'diagnostics/clear-cache' in request.path %} aria-current="page"{% endif %}>
                ğŸ§¹ Limpar Cache
              </a>
            </th>
          </tr>
          <tr class="model-health{% if 'diagnostics/system-health' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="{% url 'admin:system_health_check' %}"{% if 'diagnostics/system-health' in request.path %} aria-current="page"{% endif %}>
                ğŸ’š Health Check
              </a>
            </th>
          </tr>
          <tr class="model-debug{% if 'diagnostics/debug' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="{% url 'admin:debug_book_images' %}"{% if 'diagnostics/debug-books' in request.path %} aria-current="page"{% endif %}>
                ğŸ” Debug Imagens
              </a>
            </th>
          </tr>
          <tr class="model-recommendations{% if 'diagnostics/debug-recommendations' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="{% url 'admin:debug_recommendations' %}"{% if 'diagnostics/debug-recommendations' in request.path %} aria-current="page"{% endif %}>
                ğŸ¯ Debug RecomendaÃ§Ãµes
              </a>
            </th>
          </tr>
          <tr class="model-covers{% if 'diagnostics/fix-covers' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="{% url 'admin:fix_corrupted_covers' %}"{% if 'diagnostics/fix-covers' in request.path %} aria-current="page"{% endif %}>
                ğŸ–¼ï¸ Corrigir Capas
              </a>
            </th>
          </tr>
        </table>
      </div>

      <!-- ğŸ¤– MÃ“DULO CHATBOT LITERÃRIO - âœ… CORRIGIDO COM TREINAMENTO -->
      <div class="app-module" id="app-chatbot_literario">
        <table>
          <caption>
            <a href="/admin/chatbot_literario/" class="section">ğŸ¤– Chatbot LiterÃ¡rio</a>
          </caption>

          <!-- âœ… NOVO: Link direto para Interface de Treinamento -->
          <tr class="model-training{% if 'chatbot/treinamento' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="{% url 'chatbot_training_dashboard' %}"{% if 'chatbot/treinamento' in request.path %} aria-current="page"{% endif %}>
                ğŸ“ Interface de Treinamento
              </a>
            </th>
          </tr>

          <!-- Separador visual -->
          <tr><th scope="row" style="padding: 5px 0; border-bottom: 1px solid #ddd;"></th></tr>

          <!-- URLs tradicionais do admin -->
          <tr class="model-conversation{% if 'chatbot_literario/conversation' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="/admin/chatbot_literario/conversation/"{% if 'chatbot_literario/conversation' in request.path %} aria-current="page"{% endif %}>
                ğŸ’¬ Conversas
              </a>
            </th>
          </tr>
          <tr class="model-conversationfeedback{% if 'chatbot_literario/conversationfeedback' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="/admin/chatbot_literario/conversationfeedback/"{% if 'chatbot_literario/conversationfeedback' in request.path %} aria-current="page"{% endif %}>
                â­ Feedbacks
              </a>
            </th>
          </tr>
          <tr class="model-message{% if 'chatbot_literario/message' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="/admin/chatbot_literario/message/"{% if 'chatbot_literario/message' in request.path %} aria-current="page"{% endif %}>
                ğŸ“ Mensagens
              </a>
            </th>
          </tr>
          <tr class="model-knowledgeitem{% if 'chatbot_literario/knowledgeitem' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="/admin/chatbot_literario/knowledgeitem/"{% if 'chatbot_literario/knowledgeitem' in request.path %} aria-current="page"{% endif %}>
                ğŸ§  Base de Conhecimento
              </a>
            </th>
          </tr>
          <tr class="model-chatbotconfiguration{% if 'chatbot_literario/chatbotconfiguration' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="/admin/chatbot_literario/chatbotconfiguration/"{% if 'chatbot_literario/chatbotconfiguration' in request.path %} aria-current="page"{% endif %}>
                âš™ï¸ ConfiguraÃ§Ãµes
              </a>
            </th>
          </tr>
          <tr class="model-trainingsession{% if 'chatbot_literario/trainingsession' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="/admin/chatbot_literario/trainingsession/"{% if 'chatbot_literario/trainingsession' in request.path %} aria-current="page"{% endif %}>
                ğŸ“ SessÃµes de Treinamento
              </a>
            </th>
          </tr>
          <tr class="model-conversationsummary{% if 'chatbot_literario/conversationsummary' in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="/admin/chatbot_literario/conversationsummary/"{% if 'chatbot_literario/conversationsummary' in request.path %} aria-current="page"{% endif %}>
                ğŸ“Š Resumos de Conversas
              </a>
            </th>
          </tr>
        </table>
      </div>
      <!-- ğŸ” NOVO MÃ“DULO DE AUTENTICAÃ‡ÃƒO COMBINADO -->
      <div class="app-module active" id="app-auth-customized">
        <table>
          <caption>
            <a href="/admin/auth/" class="section">ğŸ” AutenticaÃ§Ã£o</a>
          </caption>

          <!-- Busca o modelo User do app 'core' -->
          {% for app in available_apps %}{% if app.app_label == 'core' %}{% for model in app.models %}{% if model.object_name == 'User' %}
          <tr class="model-user{% if model.admin_url in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="{{ model.admin_url }}"{% if model.admin_url in request.path %} aria-current="page"{% endif %}>
                ğŸ‘¤ {{ model.name }}
              </a>
            </th>
          </tr>
          {% endif %}{% endfor %}{% endif %}{% endfor %}

          <!-- Busca os modelos do app 'auth' (ex: Group) -->
          {% for app in available_apps %}{% if app.app_label == 'auth' %}{% for model in app.models %}
          <tr class="model-{{ model.object_name|lower }}{% if model.admin_url in request.path %} current-model{% endif %}">
            <th scope="row">
              <a href="{{ model.admin_url }}"{% if model.admin_url in request.path %} aria-current="page"{% endif %}>
                ğŸ‘¥ {{ model.name }}
              </a>
            </th>
          </tr>
          {% endfor %}{% endif %}{% endfor %}
        </table>
      </div>

      {% for app in available_apps %}
        {% if app.app_label != 'chatbot_literario' and app.app_label != 'auth' %}
          <div class="app-module{% if app.active %} active{% endif %}" id="app-{{ app.app_label }}">
            <table>
              <caption>
                {% if app.name == "AutenticaÃ§Ã£o e autorizaÃ§Ã£o" or app.name == "Authentication and Authorization" %}
                  <a href="{{ app.app_url }}" class="section">ğŸ” AutenticaÃ§Ã£o</a>
                {% elif app.name == "Core" %}
                  <a href="{{ app.app_url }}" class="section">ğŸ“š Organizador</a>
                {% else %}
                  <a href="{{ app.app_url }}" class="section">{{ app.name }}</a>
                {% endif %}
              </caption>
                {% for model in app.models %}
                {% if model.object_name != 'User' %}
                <tr class="model-{{ model.object_name|lower }}{% if model.admin_url in request.path %} current-model{% endif %}">
                  <th scope="row">
                    {% if model.admin_url %}
                      <a href="{{ model.admin_url }}"{% if model.admin_url in request.path %} aria-current="page"{% endif %}>
                        {% if model.object_name == 'User' %}ğŸ‘¤ {{ model.name }}
                        {% elif model.object_name == 'Group' %}ğŸ‘¥ {{ model.name }}
                        {% elif model.object_name == 'Book' %}ğŸ“– {{ model.name }}
                        {% elif model.object_name == 'Author' %}âœï¸ {{ model.name }}
                        {% elif model.object_name == 'Profile' %}ğŸ­ {{ model.name }}
                        {% elif model.object_name == 'Banner' %}ğŸ–¼ï¸ {{ model.name }}
                        {% elif model.object_name == 'Advertisement' %}ğŸ“¢ {{ model.name }}
                        {% elif model.object_name == 'HomeSection' %}ğŸ  {{ model.name }}
                        {% elif model.object_name == 'DefaultShelfType' %}ğŸ“š {{ model.name }}
                        {% elif model.object_name == 'BookShelfSection' %}ğŸ“‹ {{ model.name }}
                        {% elif model.object_name == 'BookShelfItem' %}ğŸ“„ {{ model.name }}
                        {% elif model.object_name == 'UserBookShelf' %}ğŸ‘¤ğŸ“š {{ model.name }}
                        {% elif model.object_name == 'VideoSection' %}ğŸ¥ {{ model.name }}
                        {% elif model.object_name == 'VideoItem' %}ğŸ“¹ {{ model.name }}
                        {% elif model.object_name == 'CustomSection' %}âš™ï¸ {{ model.name }}
                        {% elif model.object_name == 'CustomSectionType' %}ğŸ”§ {{ model.name }}
                        {% elif model.object_name == 'CustomSectionLayout' %}ğŸ¨ {{ model.name }}
                        {% elif model.object_name == 'EventItem' %}ğŸ“… {{ model.name }}
                        {% elif model.object_name == 'LinkGridItem' %}ğŸ”— {{ model.name }}
                        {% else %}ğŸ“‹ {{ model.name }}
                        {% endif %}
                      </a>
                    {% else %}
                      ğŸ“‹ {{ model.name }}
                    {% endif %}
                  </th>
                </tr>
                {% endif %}
              {% endfor %}
            </table>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  {% endif %}
</nav>

<!-- BotÃ£o de toggle DEPOIS do nav-sidebar para que o seletor ~ funcione -->
<button class="toggle-sidebar-btn" id="toggle-nav-sidebar" aria-label="{% translate 'Toggle navigation' %}">
    <i class="bi bi-chevron-left"></i>
</button>

<!-- Incluir Bootstrap Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">

<!-- CSS adicional para destacar o link de treinamento -->
<style>
/* Destaque especial para o link de treinamento */
.model-training a {
    font-weight: 600 !important;
    background: linear-gradient(135deg, #417690, #79aec8) !important;
    color: white !important;
    border-radius: 4px !important;
    padding: 8px 12px !important;
    margin: 2px 0 !important;
    display: inline-block !important;
    width: calc(100% - 24px) !important;
    text-decoration: none !important;
    transition: all 0.2s ease !important;
}

.model-training a:hover {
    background: linear-gradient(135deg, #366080, #6a9db8) !important;
    transform: translateX(2px) !important;
    box-shadow: 0 2px 8px rgba(65, 118, 144, 0.3) !important;
}

.model-training.current-model a {
    background: linear-gradient(135deg, #2c4f63, #5a8ca5) !important;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2) !important;
}

/* Separador visual */
.app-module table tr th[style*="border-bottom"] {
    height: 1px !important;
    padding: 0 !important;
    background: linear-gradient(90deg, transparent, #ddd 20%, #ddd 80%, transparent) !important;
}
</style>